!function(e,t,r){"use strict";"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()}("Refingerprint",this,function(){"use strict";function keysOf(e){var t=[],r=function(e){t.indexOf(e)<0&&t.push(e)};Object&&(Object.getOwnPropertyNames&&Object.getOwnPropertyNames(e).forEach(r),Object.keys&&Object.keys(e).forEach(r));for(var n in e)r(n);return t}function membersOf(e){var t={functions:[],types:[],fields:[]},r=function(e){return e.length>1&&e.charAt(0)==e.charAt(0).toUpperCase()&&isNaN(parseInt(e.charAt(0),10))};return keysOf(e).forEach(function(n){var o=e[n];"function"==typeof o&&isNative(o)?r(n)?t.types.push(n):t.functions.push(n):t.fields.push(n)}),t.functions.sort(),t.types.sort(),t.fields.sort(),t}function errorOf(e){var t="";return"string"==typeof e?t=e:e.message&&"string"==typeof e.message?t=e.message:e.description&&"string"==typeof e.description?t=e.description:e.toString&&"function"==typeof e.toString&&(t=e.toString()),t}function stringifyArray(e){return e.join(";")}function stringifyObject(e){return keysOf(e).map(function(t){return t+"="+e[t]}).join(";")}function stringifyMembers(e){return stringifyArray(e.types)+";"+stringifyArray(e.functions)}function snakeToPascal(e){return e.split("_").map(function(e){return e.length<2?e.charAt(0).toUpperCase():e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}).join("")}Array.prototype.forEach||(Array.prototype.forEach=function(e){for(var t=0;t<this.length;++t)e(this[t])}),Array.prototype.map||(Array.prototype.map=function(e){for(var t=[],r=0;r<this.length;++r)t[r]=e(this[r]);return t}),Array.prototype.filter||(Array.prototype.filter=function(e){for(var t=[],r=0;r<this.length;++r)e(this[r])&&(t[r]=this[r]);return t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)t.push(r);return t});var isNative=function(){var e=Object.prototype.toString,t=Function.prototype.toString,r=/^\[object .+?Constructor\]$/,n=RegExp("^"+String(e).replace(/[.*+?^${}()|[\]\/\\]/g,"\\$&").replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return function(o){var i=typeof o;return"function"==i?n.test(t.call(o)):o&&"object"==i&&r.test(e.call(o))||!1}}(),emptyDetection={result:[],raw:""},syncModules=[{name:"literal_colors",detect:function(e){var t={},r=["ActiveBorder","ActiveCaption","AppWorkspace","Background","ButtonFace","ButtonHighlight","ButtonShadow","ButtonText","CaptionText","GrayText","Highlight","HighlightText","InactiveBorder","InactiveCaption","InactiveCaptionText","InfoBackground","InfoText","Menu","MenuText","Scrollbar","ThreeDDarkShadow","ThreeDFace","ThreeDHighlight","ThreeDLightShadow","ThreeDShadow","Window","WindowFrame","WindowText"];return r.forEach(function(e){var r=document.createElement("span");r.setAttribute("style","background-color: "+e),document.body.appendChild(r);var n=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle;t[e]=n.backgroundColor,document.body.removeChild(r)}),{result:t,raw:stringifyObject(t)}}},{name:"activex_objects",detect:function(e){var t=window.ActiveXObject||window.GeckoActiveXObject||null;if(!t)return emptyDetection;var r=[],n=["Agent.Control.1","Agent.Control.2","Alttiff.AlternaTIFF ActiveX.1","Alttiff.AlternaTIFF ActiveX.1","ComCtl2.Animation.1","MSScriptControl.ScriptControl.1","Adobe.SVGCtl","IPIX.ActiveXCtrl.5","AxMetaStream.MetaStreamCtl.1","Autodesk.MGMap.1","Autodesk.MGMap.1","Wfica.WficaCtl.1","Citrix.ICAClient","Microsoft.XMLDOM","Msxml2.DOMDocument","Msxml2.DOMDocument.2.6","Msxml2.DOMDocument.3.0","Msxml2.DOMDocument.4.0","JavaSoft.JavaBeansBridge.1","Messenger.MsgrObject","SealedMedia.UnsealerPlugin.1","Cycore.Cult3D","Outc.TC.1","OPUCatalog.OPUCatalog.1","IUCtl.Update.1","DANSKESIKKER.DanskeSikkerCtrl.1","MediaPlayer.MediaPlayer.1","WMPlayer.OCX.7","{22D6F312-B0F6-11D0-94AB-0080C74C7E95}"],o=function(e){try{return new t(e)}catch(r){return!1}};return n.forEach(function(e){o(e)&&r.push(e)}),window.GeckoActiveXObject&&r.push("GeckoActiveX"),r.sort(),{result:r,raw:stringifyArray(r)}}},{name:"ms_components",detect:function(e){var t=document.createElement("div");if(t.innerHTML="<div style='behavior:url(#default#clientCaps)' ID='tempCompChecker' ></div>",document.body.appendChild(t),"undefined"==typeof tempCompChecker||"undefined"==typeof tempCompChecker.isComponentInstalled)return document.body.removeChild(t),emptyDetection;var r=[],n=[["AOL ART Image Format Support","{47F67D00-9E55-11D1-BAEF-00C04FC2D130}"],["Address Book","{7790769C-0471-11D2-AF11-00C04FA35D02}"],["Arabic Text Display Support","{76C19B38-F0C8-11CF-87CC-0020AFEECF20}"],["Chinese (Simplified) Text Display Support","{76C19B34-F0C8-11CF-87CC-0020AFEECF20}"],["Chinese (Traditional) Text Display Support","{76C19B33-F0C8-11CF-87CC-0020AFEECF20}"],["DirectAnimation Java Classes","{4F216970-C90C-11D1-B5C7-0000F8051515}"],["DirectAnimation","{283807B5-2C60-11D0-A31D-00AA00B92C03}"],["DirectShow","{44BBA848-CC51-11CF-AAFA-00AA00B6015C}"],["Dynamic HTML Data Binding for Java","{4F216970-C90C-11D1-B5C7-0000F8051515}"],["Dynamic HTML Data Binding","{9381D8F2-0288-11D0-9501-00AA00B911A5}"],["Hebrew Text Display Support","{76C19B36-F0C8-11CF-87CC-0020AFEECF20}"],["Internet Connection Wizard","{5A8D6EE0-3E18-11D0-821E-444553540000}"],["Internet Explorer Web Browser","{89820200-ECBD-11CF-8B85-00AA005B4383}"],["Internet Explorer Browsing Enhancements","{630B1DA0-B465-11D1-9948-00C04F98BBC9}"],["Internet Explorer Classes for Java","{08B0E5C0-4FCB-11CF-AAA5-00401C608555}"],["Internet Explorer Help Engine","{DE5AED00-A4BF-11D1-9948-00C04F98BBC9}"],["Internet Explorer Help","{45EA75A0-A269-11D1-B5BF-0000F8051515}"],["Internet Explorer Web Browser","{89820200-ECBD-11CF-8B85-00AA005B4383}"],["Japanese Text Display Support","{76C19B30-F0C8-11CF-87CC-0020AFEECF20}"],["Korean Text Display Support","{76C19B31-F0C8-11CF-87CC-0020AFEECF20}"],["Language Auto-Selection","{76C19B50-F0C8-11CF-87CC-0020AFEECF20}"],["Macromedia Flash","{D27CDB6E-AE6D-11CF-96B8-444553540000}"],["Macromedia Shockwave Director","{2A202491-F00D-11CF-87CC-0020AFEECF20}"],["Microsoft virtual machine","{08B0E5C0-4FCB-11CF-AAA5-00401C608500}"],["NetMeeting NT","{44BBA842-CC51-11CF-AAFA-00AA00B6015B}"],["Offline Browsing Pack","{3AF36230-A269-11D1-B5BF-0000F8051515}"],["Outlook Express","{44BBA840-CC51-11CF-AAFA-00AA00B6015C}"],["Pan-European Text Display Support","{76C19B32-F0C8-11CF-87CC-0020AFEECF20}"],["Task Scheduler","{CC2A9BA0-3BDD-11D0-821E-444553540000}"],["Thai Text Display Support","{76C19B35-F0C8-11CF-87CC-0020AFEECF20}"],["Uniscribe","{3BF42070-B3B1-11D1-B5C5-0000F8051515}"],["VRML 2.0 Viewer","{90A7533D-88FE-11D0-9DBE-0000C0411FC3}"],["Vector Graphics Rendering (VML)","{10072CEC-8CC1-11D1-986E-00A0C955B42F}"],["Vietnamese Text Display Support","{76C19B37-F0C8-11CF-87CC-0020AFEECF20}"],["Visual Basic Scripting Support","{4F645220-306D-11D2-995D-00C04F98BBC9}"],["Wallet","{1CDEE860-E95B-11CF-B1B0-00AA00BBAD66}"],["Web Folders","{73FA19D0-2D75-11D2-995D-00C04F98BBC9}"],["Windows Desktop Update NT","{89820200-ECBD-11CF-8B85-00AA005B4340}"],["Windows Media Player RealNetwork Support","{23064720-C4F8-11D1-994D-00C04F98BBC9}"],["Windows Media Player","{22D6F312-B0F6-11D0-94AB-0080C74C7E95}"],["DirectAnimation Java Classes","{4F216970-C90C-11D1-B5C7-0000F8051515}"],["DirectAnimation","{283807B5-2C60-11D0-A31D-00AA00B92C03}"],["DirectShow","{44BBA848-CC51-11CF-AAFA-00AA00B6015C}"],["MediaPlayer9","{6BF52A52-394A-11d3-B153-00C04F79FAA6}"],["MediaPlayer6","{22D6F312-B0F6-11D0-94AB-0080C74C7E95}"]],o=function(e){return tempCompChecker.isComponentInstalled(e,"ComponentID")};return n.forEach(function(e){o(e[1])&&r.push(e[0])}),document.body.removeChild(t),r.sort(),{result:r,raw:stringifyArray(r)}}},{name:"navigator_dump",detect:function(e){if("undefined"==typeof navigator)return emptyDetection;var t=membersOf(navigator);return{result:t,raw:stringifyMembers(t)}}},{name:"toolbar_dump",detect:function(e){if("undefined"==typeof toolbar)return emptyDetection;var t=membersOf(toolbar);return{result:t,raw:stringifyMembers(t)}}},{name:"crypto_dump",detect:function(e){if("undefined"==typeof crypto)return emptyDetection;var t=membersOf(crypto);return{result:t,raw:stringifyMembers(t)}}},{name:"window_dump",detect:function(e){if("undefined"==typeof window)return emptyDetection;var t=membersOf(window);return{result:t,raw:stringifyMembers(t)}}},{name:"document_dump",detect:function(e){if("undefined"==typeof document)return emptyDetection;var t=membersOf(document);return{result:t,raw:stringifyMembers(t)}}},{name:"style_dump",detect:function(e){var t=document.createElement("div"),r=keysOf(t.style);return r.sort(),{result:r,raw:stringifyArray(r)}}},{name:"error_messages",detect:function(options){var offendingFunctions=[function(){eval("var something; var whatever = something.else;")},function(){eval("var number = 42; number();")},function(){eval("var f = function () { return 0; }; f() = 1;")},function(){eval("var a = { }; var b = { a: a }; a.b = b; JSON.stringify(a);")},function(){eval("var a = 1[")},function(){eval("var f = function () { f(); }; f();")}],diagnose=function(e){try{e()}catch(t){return errorOf(t)}},result=offendingFunctions.map(function(e){return diagnose(e)});return{result:result,raw:stringifyArray(result)}}}],asyncModules=[{name:"images_formats",detect:function(e,t){var r=0,n=[],o=[".bmp",".fli",".gif",".ico",".jpg",".mng",".pbm",".pcx",".pgm",".png",".ppm",".tga",".tif",".xbm"],i=function(){++r==o.length&&t({result:n,raw:stringifyArray(n)})};o.forEach(function(t){var r=document.createElement("img");r.setAttribute("src",(e.imagesPath||"images/test")+t),r.onload=function(){n.push(t),document.body.removeChild(r),i()},r.onerror=function(){document.body.removeChild(r),i()},document.body.appendChild(r)})}}];return function(e){var t=new Fingerprint2(e);this.get=function(r){t.get(function(n,o){var i="";syncModules.filter(function(t){return!e["exclude"+snakeToPascal(t.name)]}).forEach(function(t){try{var r=t.detect(e);i+=r.raw,o.push({key:t.name,value:r.result})}catch(n){var a=errorOf(n);i+=a,o.push({key:t.name,value:a})}});var a=function(){r(n+t.x64hash128(i,31),o)},c=asyncModules.filter(function(t){return!e["exclude"+snakeToPascal(t.name)]});if(0==c.length)a();else{var u=0,s=function(t){if(i+=t.raw,o.push({key:c[u].name,value:t.result}),++u==c.length)return a();try{c[u].detect(e,s)}catch(r){var n=errorOf(r);s({result:n,raw:n})}};try{c[u].detect(e,s)}catch(C){var f=errorOf(C);s({result:f,raw:f})}}})}}});